:imagesdir: ../../images/patterns/estruturais
:source-highlighter: highlightjs
:numbered:
:unsafe:

ifdef::env-github[]
:outfilesuffix: .adoc
:caution-caption: :fire:
:important-caption: :exclamation:
:note-caption: :paperclip:
:tip-caption: :bulb:
:warning-caption: :warning:
endif::[]

= Padrões de Projetos Estruturais (Structural Design Patterns)

== Adapter (Adaptador)

https://youtu.be/45I9jX5uO9A[image:adapter-tomada.jpg[]]

=== Definição

"O padrão adapter converte a interface de uma classe em outra interface que os clientes esperam. O adaptador permite que classes anteriormente incompatíveis possam trabalhar em conjunto". <<UCPP>>

=== Aplicabilidade

Um dos casos onde o adapter é amplamente aplicado é quando utiliza-se um determinado serviço web ou biblioteca onde existem diferentes implementações dos mesmos, cada uma funcionando de uma forma diferente. Logo, o código necessário para usar um determinado serviço/biblioteca seria diferente de outro. Normalmente vão existir vários métodos com nomes e parâmetros diferentes (assinaturas). Assim, trocar tal serviço/biblioteca por outro pode ser um trabalho complexo. 

Um adapter neste caso pode fornecer uma interface padrão a ser utilizada publicamente, encapsulando as diferenças entre um(a) serviço/biblioteca e outro(a).

=== Modelagem do Padrão

image::xxxx.png[]

=== Princípios utilizados


=== Exemplos

- Geração de números verdadeiramente aleatórios utilizando serviços web como o http://random.org e http://random.irb.hr

== Padrões Relacionados


== Onde o padrão é usado no JDK

== Exercícios

=== Adaptando a aplicação de consulta de CEP

Voltando ao link:../../../criacionais/cep-service/cep-service-producer[projeto que utiliza serviços de consulta de CEP] disponíveis na web, cada serviço retorna um objeto endereço em um formato diferente do outro, como pode verificar nestes links para o https://viacep.com.br/ws/01001000/json/[ViaCep] e o https://api.postmon.com.br/v1/cep/77021090[Postmon].

Como podemos aplicar o padrão adapter para resolver este problema? 
Qual a solução mais simples possível?

Para resolver o problema, você precisará fazer o processamento manual do código JSON recebido
pelo serviço, que representa o endereço de um determinado CEP.
Para isso, vamos usar a biblioteca https://javaee.github.io/jsonp/getting-started.html[JSON-P (JSON Processing)] da plataforma Java. 
Assim, adicione as seguintes dependências ao arquivo pom.xml do seu projeto Maven.

[source,xml]
----
<dependency>
    <groupId>javax.json</groupId>
    <artifactId>javax.json-api</artifactId>
    <version>1.0</version>
</dependency>

<dependency>
    <groupId>org.glassfish</groupId>
    <artifactId>javax.json</artifactId>
    <version>1.0</version>
</dependency>
----

Você pode usar um código como abaixo para fazer o tal processamento:

[source,java]
----
JsonReader reader = Json.createReader(new StringReader(json));
JsonObject object = reader.readObject();
Endereco endereco = new Endereco();
endereco.setLogradouro(object.getString("logradouro"));
----

Veja o projeto link:cep-service-adapter-automatico[cep-service-adapter-automatico] para uma implementação extremamente simplificada.

=== Cotações de Empresas da Bolsa de Valores

A partir do projeto base link:cotacao-bolsa-valores[cotacao-bolsa-valores], 
que realiza a cotação de ações de empresas da bolsa de valores, implemente o padrão
Adapter para padronizar a interface de acesso a tais serviços.
